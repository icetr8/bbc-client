function Xtion_html_special_chars(t,e){if(null!=t){var n=3;e=void 0!==e&&e;var o=0,i=0,s=!1;void 0!==n&&null!==n||(n=2),t=t.toString(),!1!==e&&(t=t.replace(/&/g,"&amp;")),t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;");var a={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(0===n&&(s=!0),"number"!=typeof n){for(n=[].concat(n),i=0;i<n.length;i++)0===a[n[i]]?s=!0:a[n[i]]&&(o|=a[n[i]]);n=o}return n&a.ENT_HTML_QUOTE_SINGLE&&(t=t.replace(/'/g,"&#039;")),s||(t=t.replace(/"/g,"&quot;")),t}return""}function Xtion_html_entity_decode(t){var e=document.createElement("textarea");return e.innerHTML=t,e.value}function Xtion_utf8_encode(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var o=t.charCodeAt(n);o<128?e+=String.fromCharCode(o):o>127&&o<2048?(e+=String.fromCharCode(o>>6|192),e+=String.fromCharCode(63&o|128)):(e+=String.fromCharCode(o>>12|224),e+=String.fromCharCode(o>>6&63|128),e+=String.fromCharCode(63&o|128))}return e}function Xtion_utf8_decode(t){for(var e="",n=0,o=c1=c2=0;n<t.length;)(o=t.charCodeAt(n))<128?(e+=String.fromCharCode(o),n++):o>191&&o<224?(c2=t.charCodeAt(n+1),e+=String.fromCharCode((31&o)<<6|63&c2),n+=2):(c2=t.charCodeAt(n+1),c3=t.charCodeAt(n+2),e+=String.fromCharCode((15&o)<<12|(63&c2)<<6|63&c3),n+=3);return e}function Xtion_base64_encode(t){var e,n,o,i,s,a,r,c="",u=0;for(t=Xtion_utf8_encode(t);u<t.length;)i=(e=t.charCodeAt(u++))>>2,s=(3&e)<<4|(n=t.charCodeAt(u++))>>4,a=(15&n)<<2|(o=t.charCodeAt(u++))>>6,r=63&o,isNaN(n)?a=r=64:isNaN(o)&&(r=64),c=c+Xtion_base64_key.charAt(i)+Xtion_base64_key.charAt(s)+Xtion_base64_key.charAt(a)+Xtion_base64_key.charAt(r);return c}function Xtion_base64_decode(t){var e,n,o,i,s,a,r="",c=0;for(t=t.replace(/[^A-Za-z0-9+\/=]/g,"");c<t.length;)e=Xtion_base64_key.indexOf(t.charAt(c++))<<2|(i=Xtion_base64_key.indexOf(t.charAt(c++)))>>4,n=(15&i)<<4|(s=Xtion_base64_key.indexOf(t.charAt(c++)))>>2,o=(3&s)<<6|(a=Xtion_base64_key.indexOf(t.charAt(c++))),r+=String.fromCharCode(e),64!=s&&(r+=String.fromCharCode(n)),64!=a&&(r+=String.fromCharCode(o));return Xtion_utf8_decode(r)}function Xtion_select_text(t){if(document.body.createTextRange)(n=document.body.createTextRange()).moveToElementText(t),n.select();else if(window.getSelection){var e=window.getSelection(),n=document.createRange();n.selectNodeContents(t),e.removeAllRanges(),e.addRange(n)}}function Xtion_object_merge(t,e){if(t&&e){for(var n in e)e.hasOwnProperty(n)&&!t[n]&&(t[n]=e[n]);return t}return e||t||{}}function Xtion_form_to_json(t,e){if(e=e||{},e.name_prefixing=function(t){return(e.prefix?e.prefix:"")+(e.prefix_remove?t.replace(e.prefix_remove,""):t)},"undefined"!=typeof CKEDITOR)for(var n=t.getElementsByClassName("cke"),o=n.length;o--;)(r=CKEDITOR.instances[n[o].id.substr(4)])&&(r.element.$.value=r.getData());for(var i=e.array?[{}]:e.update?e.update:{},s=t.elements?t.elements:t.querySelectorAll("input,textarea,select"),o=0,a=s.length;o<a;o++)if(!s[o].disabled){var r=e.name_prefixing(s[o].name);if(r){var c=s[o].value;if(e.selects_use_text&&"SELECT"===s[o].tagName?c=s[o].options[s[o].selectedIndex].text:"INPUT"===s[o].tagName&&"checkbox"===s[o].type?c=s[o].checked?1:0:"SELECT"===s[o].tagName&&s[o].multiple&&(c=[],s[o].options.forEach(function(t){t.selected&&c.push(t.value)})),c=e.modify&&e.modify[r]?e.modify[r](c):c,e.array)if(r=r.replace("[]",""),i[i.length-1][r]){var u={};u[r]=c,i.push(u)}else i[i.length-1][r]=c;else"[]"!==r.substr(-2,2)||s[o].multiple?i[r]=c:(i[r]||(i[r]=[]),i[r].push(c))}}if(e.array_all){var l=[{}];for(var o in i)if(i[o]instanceof Array)for(var p=0;p<i[o].length;p++)l[p]||(l[p]={}),l[p][o.replace("[]","")]=i[o][p];else l[0][o]=i[o];i=l}return i}function Xtion_json_to_form(t,e,n){n=n||{};var o=document.createElement("form");o.action="javascript:",o.onsubmit=function(){t=Xtion_form_to_json(this,{modify:n.modify,update:t}),e&&e(t,o)};var i="";for(var s in t)if(t.hasOwnProperty(s)&&"string"==typeof t[s])if(n.input&&n.input[s]){var a=n.input[s];if("textarea"===n.input[s]||n.input[s].type&&"textarea"===n.input[s].type)i+="<label>"+s+':<textarea name="'+s+'" class="'+(n.input_classes&&n.input_classes[s]?n.input_classes[s]:"")+'" '+(a.placeholder?' placeholder="'+a.placeholder+'"':"")+">"+Xtion_html_special_chars(t[s])+"</textarea></label>";else if(n.input[s]instanceof Object){var r=n.input[s];i+="<label>"+s+':<select name="'+Xtion_html_special_chars(s)+'">';for(var c in r)r.hasOwnProperty(c)&&(i+='<option value="'+Xtion_html_special_chars(c)+'"'+(c==t[s]?" selected":"")+">"+Xtion_html_special_chars(r[c])+"</option>");i+="</select></label>"}}else i+="<label>"+s.replace("_"," ")+':<input name="'+s+'" value="'+Xtion_html_special_chars(t[s])+'" type="'+(n.input_types?n.input_types[s]||"text":"text")+'" class="'+(n.input_classes&&n.input_classes[s]?n.input_classes[s]:"")+'"/></label>';o.innerHTML=(n.prepend||"")+i;var u=document.createElement("input");return u.type="submit",u.value="Submit",o.appendChild(u),o}function Xtion_json_to_form_submit(t,e,n){n=n||{};var o=document.createElement("form");o.setAttribute("action",e),o.setAttribute("method",n.method||"post"),o.className="Xtion_form Xtion_json_to_form_submit",n.pre&&(o.innerHTML+=n.pre);var i=document.createElement("div");i.className="Xtion_form_output",o.appendChild(i);for(var s in t)t.hasOwnProperty(s)&&(n.hidden&&~n.hidden.indexOf(s)?o.innerHTML+='<input type="hidden" name="'+s+'" value="'+Xtion_html_special_chars(t[s])+'"/>':o.innerHTML+="<label>"+(n.label&&n.label[s]?n.label[s]:s.replace(/_/g," ").replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}))+': <input type="text" name="'+s+'" value="'+Xtion_html_special_chars(t[s])+'"/></label>');var a=document.createElement("input");a.type="submit",o.appendChild(a);var r=new XtionForm;return r.form=o,r.output=o.querySelector(".Xtion_form_output"),r.success_false_function=n.success_false_function,r.success_true_function=n.success_true_function,r.success_true_refresh=n.success_true_refresh,r.Initialize(),o}function Xtion_json_to_inputs_hidden(t){var e="";for(var n in t)t.hasOwnProperty(n)&&"string"==typeof t[n]&&(e+='<input name="'+n+'" value="'+Xtion_html_special_chars(t[n])+'" type="hidden"/>');return e}function Xtion_form_fill(t,e,n){n=n||{};for(var o=t.elements,i=n.exclude?n.exclude:{submit:1,button:1,hidden:1},s=o.length;s--;)i[o[s].type]||(o[s].multiple&&e[o[s].name]instanceof Array?o[s].options.forEach(function(t){~e[o[s].name].indexOf(t.value)&&(t.selected=!0)}):(o[s].value=e[o[s].name]||"",o[s].onchange&&o[s].onchange()))}function Xtion_form_disable(t,e){for(var n=t.elements?t.elements:t.querySelectorAll("input,textarea,select"),o=0,i=n.length;o<i;o++)n[o].disabled=!e}function Xtion_url_parameters(t){if(void 0===t&&(t=location.search),t){~t.indexOf("?")?(t=t.split("?"))[1]&&(t[0]=t[1]):t=[t],~t[0].indexOf("#")&&(t[0]=t[0].split("#")[0]);var e={};return t[0].split("&").forEach(function(t){t=t.split("="),e[t[0]]=decodeURIComponent(t[1]||"").replace(/\+/g," ")}),JSON.parse(JSON.stringify(e))}}function Xtion_query_parameters(t){return Xtion_url_parameters(t)}function Xtion_uri_query_parameters(t){return Xtion_url_parameters(t)}function Xtion_url_parameters_flatten(t,e){var n=[];for(var o in t)if(t.hasOwnProperty(o)){var i=e?e+"["+o+"]":o,s=t[o];n.push("object"==typeof s?Xtion_url_parameters_flatten(s,i):encodeURIComponent(i)+"="+encodeURIComponent(s))}return n.join("&")}function Xtion_url_parameter_set(t,e){var n=e&&1!=e?e:location.href,o=Xtion_url_parameters(n);for(var i in t)t.hasOwnProperty(i)&&(o[i]=t[i]);return n=n.split("?")[0]+"?"+Xtion_url_parameters_flatten(o),1==e&&(location.href=n),n}function Xtion_equality(t,e){if(t instanceof Array&&e instanceof Array){if(!t||!e||t.length!=e.length)return!1;for(var n=0,o=t.length;n<o;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!Xtion_equality(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}return console.error("Xtion_equality Non-Arrays Not Yet Supported"),!1}function Xtion_this_script(){return document.scripts[document.scripts.length-1]}function Xtion_script(t,e){var n=document.querySelector('script[src="'+t+'"]');if(n)e&&n.addEventListener("load",function(t){e(t)});else{(n=document.createElement("script")).src=t,e&&n.addEventListener("load",function(t){e(t)});var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(n,o)}}function Xtion_elements_delete(t){if(t){t.tagName&&(t=[t]);for(var e=t.length;e--;)t[e].parentNode.removeChild(t[e])}}function Xtion_form_reset(t){t.reset();for(var e=t.querySelectorAll("select"),n=0;n<e.length;n++)e[n].onchange&&e[n].onchange()}function Xtion_object_key_delete(t,e){for(var n in t)~e.indexOf(n)&&delete t[n];return t}function Xtion_string_between(t,e,n){var o=t.indexOf(e);if(~o){var i=-1;if((n instanceof Array?n:[n]).forEach(function(n){var s=t.substr(o+e.length).indexOf(n);~s&&(i=-1===i||s<i?s:i)}),~i)return t.substr(o+e.length,i)}return""}function Xtion_image_url_data(t,e){var n=new Image;n.crossOrigin="anonymous",n.src=t;var o=0;n.onload=function(){o||(o=1,window.canvas=document.createElement("canvas"),canvas.width=n.naturalWidth,canvas.height=n.naturalHeight,canvas.getContext("2d").drawImage(n,0,0),e(canvas.toDataURL()))}}function Xtion_image_url_data_xhr(t,e){var n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.send(),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var o=new FileReader;o.onload=function(t){e(t.target.result)},o.readAsDataURL(new Blob([n.response],{type:~t.indexOf(".png")?"image/png":"image/jpg"}))}}}function Xtion_key_whitelist(t,e){var n={};return e.forEach(function(e){t[e]&&(n[e]=t[e])}),n}function Xtion_string_contains(t,e){if("string"==typeof e)return!!~t.indexOf(e);if(e instanceof Array){var n=!1;return e.forEach(function(e){~t.indexOf(e)&&(n=!0)}),n}console.log("Xtion_string_contains invalid type: "+typeof e)}function Xtion_elements_contain(t,e,n,o){var i=[];return Xtion_foreach(e instanceof Array?e:[e],function(e){Xtion_foreach(t,function(t){(o?t[n?"innerHTML":"textContent"]===e:RegExp(e).test(t[n?"innerHTML":"textContent"]))&&i.push(t)})}),i}function Xtion_foreach(t,e,n){if(t)if(t.constructor===Array)for(var o=0;o<t.length;o++)e(t[o],o,n instanceof Array?n:[]),n&&"object"==typeof t[i]&&Xtion_foreach(t[i],e,n instanceof Array?n.concat([i]):[i]);else for(var i in t)t.hasOwnProperty(i)&&(e(t[i],i,n instanceof Array?n:[]),n&&"object"==typeof t[i]&&Xtion_foreach(t[i],e,n instanceof Array?n.concat([i]):[i]))}function Xtion_parents(t,e){if("number"==typeof e){for(;e--;)t=t.parentNode;return t}for(;t.parentNode&&t.parentNode.parentNode;){if(~[].indexOf.call(t.parentNode.parentNode.querySelectorAll(e)||[],t.parentNode))return t.parentNode;t=t.parentNode}return null}function Xtion_element_coordinates(t,e){var n=t.getBoundingClientRect(),o=document.body,i=document.documentElement,s=e?0:window.pageYOffset||i.scrollTop||o.scrollTop,a=e?0:window.pageXOffset||i.scrollLeft||o.scrollLeft,r=i.clientTop||o.clientTop||0,c=i.clientLeft||o.clientLeft||0;return{top:Math.round(n.top+s-r),left:Math.round(n.left+a-c)}}function Xtion_time_ago(t){var e;if(isNaN(t)){var n=new Date,o=new Date(n.getFullYear(),0,1),i=new Date(n.getFullYear(),6,1);n=n.getTimezoneOffset()<Math.max(o.getTimezoneOffset(),i.getTimezoneOffset()),e=new Date(Date.parse(t.replace(" ","T")+"-0"+(n?"7":"8")+"00"))}else e=new Date(1e3*t);var s,a=new Date-e;return a<6e4?(s=Math.round(a/1e3))+" second"+(1==s?"":"s")+" ago":a<36e5?(s=Math.round(a/6e4))+" minute"+(1==s?"":"s")+" ago":a<864e5?(s=Math.round(a/36e5))+" hour"+(1==s?"":"s")+" ago":a<2592e6?(s=Math.round(a/864e5))+" day"+(1==s?"":"s")+" ago":a<31536e6?(s=Math.round(a/2592e6))+" month"+(1==s?"":"s")+" ago":(s=Math.round(a/31536e6))+" year"+(1==s?"":"s")+" ago"}function Xtion_indexesof(t,e){var n,o=[];for(n=0;n<t.length;n++)t[n]===e&&o.push(n);return o}function Xtion_instr(t,e){if(t){if(!(e instanceof Array))return!!~t.indexOf(e);for(var n=0;n<e.length;n++)if(~t.indexOf(e[n]))return!0}return!1}function Xtion_xpath_element(t,e){return document.evaluate(t,e||document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}function Xtion_xpath_elements(t,e){for(var n=[],o=document.evaluate(t,e||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),i=0,s=o.snapshotLength;i<s;++i)n.push(o.snapshotItem(i));return n}function Xtion_request(t,e,n){n="string"==typeof n?{post:n}:n||{};var o=Object.assign({},n),i=document.getElementsByTagName("html")[0].style;i.cursor="progress";var s=null;if(n.loading_overlay&&(s=Xtion_popup_loading()),n.method=n.method||(n.post||n.files?"POST":"GET"),n.async=void 0===n.async||n.async,n.files){if(n.data=new FormData,n.post)if("string"==typeof n.post&&(n.post=Xtion_url_parameters(n.post)),"object"==typeof n.post)for(var a in n.post)n.post.hasOwnProperty(a)&&n.data.append(a,n.post[a]);else console.log("Request Post data is invalid");for(var a in n.files)n.files.hasOwnProperty(a)&&n.data.append(a,n.files[a])}else if(n.post&&"object"==typeof n.post&&(n.data||(n.data=n.post instanceof HTMLElement?new FormData(n.post):new FormData),!(n.post instanceof HTMLElement))){var r=function(t,e){for(var o in t)if(t.hasOwnProperty(o)){var i=e?e+"["+o+"]":"";t[o]===Object(t[o])?r(t[o],i||o):n.data.append(i||o,t[o])}};r(n.post)}if(xtion.csrf){var c=encodeURIComponent(xtion.csrf);n.data?n.data.append("_t",c):n.post?n.post+="&_t="+c:t+=(~t.indexOf("?")?"&":"?")+"_t="+c}var u=new XMLHttpRequest,l=(new Date).getTime();if(u.open(n.method?n.method:"GET",t,n.async),n.retry){var p=n.error?n.error.bind():function(){};n.error=function(i){n.retry_count=n.retry_count?n.retry_count+1:1,n.retry_count<=n.retry?setTimeout(function(){Xtion_request(t,e,Object.assign(o,{retry_count:n.retry_count}))},"timeout"===i?0:n.retry_delay||1e3*n.retry_count*2):p(i)}}if(!n.post||n.data||n.files||n.headers&&n.headers["content-type"]||u.setRequestHeader("content-type","application/x-www-form-urlencoded"),n.headers)for(var _ in n.headers)n.headers.hasOwnProperty(_)&&u.setRequestHeader(_,n.headers[_]);if(n.timeout&&(u.timeout=n.timeout),n.error&&(u.ontimeout=function(){s&&s.close(),i.cursor="",n.error("timeout"),console.log("Request Timeout ("+((new Date).getTime()-l)/1e3+"s)")}),n.response_type&&(u.responseType=n.response_type),n.xhr)for(var h in n.xhr)u[h]=n.xhr[h];u.send(n.data?n.data:n.post);var d=function(){4===u.readyState&&(s&&s.close(),i.cursor="",200===u.status||n.any_status?e&&("function"==typeof e?e(n.response_full?u:"blob"===n.response_type?u.response:u.responseText):"object"==typeof e&&(e.innerHTML=u.responseText)):(n.error&&n.error(u.status),console.log("Request Failed Status "+u.status)))};return n.async?u.onreadystatechange=d:d(),u}function Xtion_request_action(t,e,n){xtion.Xtion_request_action_api&&((n=n||{}).post=n.post?Xtion_object_merge(n.post,{api:xtion.Xtion_request_action_api}):{api:xtion.Xtion_request_action_api}),Xtion_request(LOCATION_ACTION+t,e,n)}function Xtion_request_out_save(t){1!=t&&(alert("Error: "+t),console.error(t))}function Xtion_request_out_save_refresh(t,e){1==t?(e?window.top:window).location.reload():(alert("Error: "+t),console.error(t))}function Xtion_request_out_save_refresh_top(t){Xtion_request_out_save_refresh(t,1)}function Xtion_request_out_alert(t){alert(t)}function Xtion_request_out_updated(t){1==t?alert("Updated"):(alert("Error: "+t),console.error(t))}function Xtion_popup(t,e){var n=t,o=(e=Xtion_object_merge(e,xtion.Xtion_popup)).target?e.target:window,i=e.target?e.target.document:document;if(t&&"object"==typeof t&&t.classList&&t.classList.contains("Xtion_popup_use")){if(t.style.display="",e.info_input){e.info||(e.info="");for(var s in e.info_input)e.info+='<input type="hidden" name="'+Xtion_html_special_chars(s)+'" value="'+Xtion_html_special_chars(e.info_input[s])+'"/>'}e.info&&((h=t.getElementsByClassName("Xtion_popup_content_info"))[0]?h[0].innerHTML=e.info:console.error("Xtion_popup No Info Element")),e.form_reset&&(h=t.getElementsByTagName("form"))&&Xtion_form_reset(h[0]),e.form_fill&&(h=t.getElementsByTagName("form"))&&Xtion_form_fill(h[0],e.form_fill);var a=i.querySelectorAll("body>div.Xtion_popup_container").length;a&&(t.style.zIndex=1e4+a),(h=t.getElementsByClassName("Xtion_popup_content")).length&&(h[0].scrollTop=0)}else{if(e.group){var r=e.group.group[e.group.position-1];r||(r=e.group.group[e.group.group.length-1]),e.previous=i.createElement("button"),e.previous.innerHTML="&#8678;",e.previous.onclick=function(){this.parentNode.parentNode.parentNode.previousSibling.onclick(),Xtion_popup(r.content,r.options_popup)};var c=e.group.group[e.group.position+1];c||(c=e.group.group[0]),e.next=i.createElement("button"),e.next.innerHTML="&#8680;",e.next.onclick=function(){this.parentNode.parentNode.parentNode.previousSibling.onclick(),Xtion_popup(c.content,c.options_popup)}}if(n=i.createElement("div"),e.id&&(n.id=e.id),n.className="Xtion_popup_container"+(e.container_classes?" "+e.container_classes:""),e.container_click&&n.addEventListener("click",e.container_click),i.body.appendChild(n),0!==e.overlay){var u=i.createElement("div");u.className="Xtion_popup_overlay",0!==e.overlay_close&&(u.onclick=function(){o.Xtion_popup_close(this.parentNode)}),n.appendChild(u)}var l=i.createElement("div");l.className="Xtion_popup_content_container",l=n.appendChild(l);var p=i.createElement("div");p.className="Xtion_popup_content"+(e.content_class?" "+e.content_class:""),e.width&&(p.style.width=e.width+"px"),t.substr&&"http"===t.substr(0,4)&&(t='<iframe src="'+t+'"></iframe>'),p=l.appendChild(p),"object"!=typeof t||1!==t.nodeType&&11!==t.nodeType?p.innerHTML+=t:p.appendChild(t),e.next&&content_actions.insertBefore(e.next,content_actions.firstChild),e.previous&&content_actions.insertBefore(e.previous,content_actions.firstChild),e.xtion_detect&&Xtion_detect(p)}var _=["Xtion_popup_showing"].concat(e.body_classes?e.body_classes instanceof Array?e.body_classes:e.body_classes.split(" "):[]);_.forEach(function(t){i.body.classList.add(t)});var h=n.querySelector("[data-xtion-focused]");h&&h.focus(),xtion.hook&&xtion.hook.Xtion_popup&&xtion.hook.Xtion_popup.end&&xtion.hook.Xtion_popup.end();var d={container:n,body_classes:_,close:function(){o.Xtion_popup_close(n)}};return o.Xtion_popups.push(d),d}function Xtion_popup_close(t){if(!t)if(Xtion_popups.length)t=Xtion_popups[Xtion_popups.length-1];else for(var e=document.getElementsByClassName("Xtion_popup_container"),n=e.length;n--;)if(!e[n].style.display){t=e[n];break}if(t){var o=t.container?t.container:t,i={body_classes:["Xtion_popup_showing"]};for(Xtion_popups.forEach(function(e){e.container===t&&(i=e)}),o.classList.contains("Xtion_popup_use")?o.style.display="none":o.parentNode.removeChild(o),i.body_classes.forEach(function(t){document.body.classList.remove(t)}),Xtion_popup_event(o,"close");~Xtion_popups.indexOf(t);)Xtion_popups.splice(Xtion_popups.indexOf(t),1)}}function Xtion_popups_close(){for(var t=document.getElementsByClassName("Xtion_popup_container"),e=t.length;e--;){var n={body_classes:[]};Xtion_popups.forEach(function(o){o.container===t[e]&&(n=o)}),n.body_classes.forEach(function(t){document.body.classList.remove(t)}),t[e].classList.contains("Xtion_popup_use")?t[e].style.display="none":t[e].parentNode.removeChild(t[e]),Xtion_popup_event(t[e],"close")}document.body.classList.remove("Xtion_popup_showing"),window.Xtion_popups_close_extend&&window.Xtion_popups_close_extend(),Xtion_popups=[]}function Xtion_popup_event(t,e){if(t)switch(e){case"close":var n=t.getAttribute("data-xtion-close");n&&new Function("e",n)(t),(n=t.getElementsByClassName("Xtion_popup_content_info"))[0]&&(n[0].innerHTML=""),t.style.zIndex="";break;default:console.error("Xtion_popup_event Invalid")}}function Xtion_popup_alert(t){"string"==typeof t&&(t={message:t});var e=document.createDocumentFragment();if(t.title){var n=document.createElement("h1");n.innerHTML=t.title,e.appendChild(n)}if(t.message){var o=document.createElement("p"),i=t.message;"object"!=typeof i||1!==i.nodeType&&11!==i.nodeType?o.innerHTML+=i:o.appendChild(i),e.appendChild(o)}var s=document.createElement("div");s.className="Xtion_popup_actions",e.appendChild(s);var a=document.createElement("button");a.style.width="100%",a.innerHTML="Okay",a.addEventListener("click",function(t){return t.preventDefault(),t.stopPropagation(),Xtion_popup_close(this.parentNode.parentNode.parentNode.parentNode),!1}),s.appendChild(a),Xtion_popup(e,{container_classes:"Xtion_popup_alert_container"})}function Xtion_popup_confirm(t,e){t="string"==typeof t?{message:t}:Xtion_object_merge(t,Xtion_object_merge(xtion.Xtion_popup_confirm,xtion.Xtion_popups));var n=document.createDocumentFragment();if(t.title){var o=document.createElement("h1");o.innerHTML=t.title,n.appendChild(o)}if(t.message){var i=document.createElement("p");i.innerHTML=t.message,n.appendChild(i)}var s=document.createElement("div");if(s.className="Xtion_popup_content_actions",n.appendChild(s),t.actions_extra?(t.actions_extra.unshift(t.actions_okay||"Okay"),t.actions_extra.push(t.actions_cancel||"Cancel")):t.actions_extra=[t.actions_okay||"Okay",t.actions_cancel||"Cancel"],t.actions_extra)for(var a=0;a<t.actions_extra.length;a++){var r=document.createElement("button");r.setAttribute("data-action",a===t.actions_extra.length-1?0:a+1),r.innerHTML=t.actions_extra[a],r.addEventListener("click",function(t){return t.preventDefault(),t.stopPropagation(),Xtion_popup_close(this.parentNode.parentNode.parentNode.parentNode),e(parseInt(this.getAttribute("data-action")),t),!1}),s.appendChild(r)}Xtion_popup(n,{container_classes:"Xtion_popup_confirm_container",cancel_callback:t.cancel_callback})}function Xtion_popup_prompt(t,e,n){if(n=n||{},!("object"==typeof s&&s.length>=2)){var o=document.createElement("form");o.action="javascript:";var i=document.createElement("div");i.className="Xtion_popup_prompt_inputs",i=o.appendChild(i);var s=document.createElement("label");s.innerHTML=t.label||t,s=i.appendChild(s);var a=t.type?document.createElement("textarea"):document.createElement("input");a=s.appendChild(a),"string"!=typeof e&&"number"!=typeof e||(a.value=e),"string"!=typeof n&&"number"!=typeof n||(a.value=n),n.value&&(a.value=n.value);var r=document.createElement("div");r.className="Xtion_popup_prompt_actions",r=o.appendChild(r);var c=document.createElement("button");c.innerHTML="Ok",c.onclick=function(){"function"==typeof e&&e(a.value),this.nextSibling.onclick()},r.appendChild(c);var u=Xtion_popup(o,Xtion_object_merge(n.popup?n.popup:{},{container_classes:"Xtion_popup_prompt"})),l=document.createElement("button");return l.innerHTML="Cancel",l.onclick=function(){u.close()},r.appendChild(l),u}}function Xtion_prompt(t,e,n){return Xtion_popup_prompt(t,e,n)}function Xtion_popup_prompt_form(t,e,n){return n=n||{},Xtion_popup(Xtion_json_to_form(t,e,n),Xtion_object_merge(n.popup?n.popup:{},{container_classes:"Xtion_popup_prompt_form"}))}function Xtion_popup_select(t,e,n){n=n||{};var o=document.createDocumentFragment();if(n.header){var i=document.createElement("header");i.innerHTML=n.header,o.appendChild(i)}return Xtion_foreach(t,function(t,i){t instanceof Object&&(i=void 0!==t[n.key||"key"]?t[n.key||"key"]:i,t=void 0!==t[n.value||"value"]?t[n.value||"value"]:t);var s=document.createElement("div");s.setAttribute("data-xtion-value",i);var a=document.createElement("a");a[n.html?"innerHTML":"textContent"]=t,s.appendChild(a),n.suffix&&(s.innerHTML+=n.suffix),s.onclick=function(){e(i,this.textContent),s.offsetParent&&!n.noclose&&Xtion_popup_close(Xtion_parents(s,".Xtion_popup_container"))},o.appendChild(s)}),Xtion_popup(o,Xtion_object_merge(n.popup?n.popup:{},{container_classes:"Xtion_popup_select"}))}function Xtion_popup_loading(t){t=t||{};var e=document.createElement("div");if((t.loading||xtion.loading)&&(e.innerHTML=t.loading||xtion.loading),t.message&&(e.innerHTML+="<p>"+t.message+"</p>"),t.cancel){var n=document.createElement("button");n.innerHTML="Cancel",n.onclick=t.cancel,e.appendChild(n)}return Xtion_popup(e,Xtion_object_merge(t.popup?t.popup:{},{overlay_close:0,container_classes:"Xtion_popup_loading_container"}))}function Xtion_popup_temporary(t,e){var n=Xtion_popup(t,Xtion_object_merge({container_classes:"Xtion_popup_temporary_container"+((e="number"==typeof e?{time:e}:e||{}).class?" "+e.class:""),overlay:0},e));setTimeout(function(){n.container.classList.add("Xtion_popup_temporary_container_animation")},50),setTimeout(function(){n.close()},e.time||5e3)}function XtionPopup(t,e){e=e||{};var n=this;this.content='<img src="'+t.href+'" alt="Full Image"'+(e.click_next?' onclick="this.parentNode.lastChild.lastChild.previousSibling.onclick();"':"")+"/>",t.href&&~t.href.indexOf("www.youtube.com/watch?v=")&&(this.content='<iframe width="420" height="315" src="//www.youtube-nocookie.com/embed/'+t.href.split("v=")[1].split("&")[0]+'?rel=0" frameborder="0" allowfullscreen></iframe>'),window["Xtion_popup_group_"+e.group]?window["Xtion_popup_group_"+e.group].push(this):window["Xtion_popup_group_"+e.group]=[this],this.group=window["Xtion_popup_group_"+e.group],this.group_position=this.group.length-1,this.options_popup={},e.group&&(this.options_popup.group={position:n.group_position,group:n.group}),t.onclick=function(t){t.preventDefault(),Xtion_popup(n.content,n.options_popup)}}function XtionForm(t,e){this.form=t,this.output=e,this.form_submitted_button=null,this.action,this.method,this.parameters="",this.flatten=0,this.input_parameters={},this.output_loading="Loading...",this.output_error="There were problems with your input, please fix them.",this.loading_overlay=!1,this.errors=0,this.error_type="text",this.error_show="visibility",this.success_output="bool",this.success_output_function=null,this.success_function=0,this.success_true="",this.success_true_function=0,this.success_true_redirect="",this.success_true_hide=0,this.success_true_reset=0,this.success_true_refresh=0,this.success_false="",this.success_false_function=0,this.success_false_output=1,this.disable_hidden=0,this.output_progressive=0}function XtionSwitcher(t,e,n){this.type="selector",this.container=t,this.controller=e,this.content=n,this.actions_selected="Xtion_switcher_selected",this.loads_selected="Xtion_switcher_selected",this.selected=0,this.load_hashes=0,this.func,this.function_after_first=0,this.current=0}function XtionAutoexpand(t,e){this.element=t,this.height=parseInt(e)||60,this.height_changed=0,this.dimensions=null,this.enabled=!0,this.Initialize=function(){var t=this;this.element.onkeyup=function(){t.enabled&&(this.style.height="",this.style.height=this.scrollHeight>t.height?this.scrollHeight+2+"px":"")},this.element.onfocus=function(){setTimeout(function(){t.element.onkeyup()},300)},this.element.onmousedown=function(){t.dimensions=[this.clientWidth,this.clientHeight]},this.element.onmouseup=function(){t.dimensions&&!Xtion_equality(t.dimensions,[this.clientWidth,this.clientHeight])&&(t.enabled=!1)}}}function Xtion_slideshow(t,e,n){this.container=t,this.slideshow=e,this.slides=[],this.navigation=n,this.slideshow_width=0,this.image_amount,this.image_length=[],this.auto=1,this.speed=40,this.speed_change=0,this.delay=5e3,this.delay_change=0,this.run_with_one,this.navigation_arrows=0,this.navigation_arrows_hide=0,this.nav_buttons=1,this.nav_button_type=0,this.nav_button,this.nav_button_selected,this.nav_button_selected_name="Xtion_slideshow_navigation_selected",this.nav_button_img=this.nav_button_img_selected=0,this.onslidechange=null,this.current_slide=0,this.changing=0,this.slideshow_timer,this.slideshow_pause,this.slideshow_change,this.slideshow_continue}function Xtion_detect(t,e){var n="."+Object.keys(window.xtion.detection).join(",."),o=t?t.querySelectorAll(n):document.querySelectorAll(n);t&&~t.className.indexOf("Xtion_")&&((o=Array.prototype.slice.call(o))?o.push(t):o=[t]);for(var i=0;i<o.length;i++)if(!~Xtion_detected_elements.indexOf(o[i])){window.Xtion_detected_elements.push(o[i]);for(var s in window.xtion.detection)if(window.xtion.detection.hasOwnProperty(s)&&o[i].classList.contains(s)){var a={},r=o[i].getAttribute("data-xtion");if(r)for(var c=(r=r.replace(/\\;/g,"XTION_ESCAPED_SEMICOLON").split(";")).length;c--;)(u=[(l=r[c].split(":")).shift(),l.join(":")])[1]&&(u[1]=u[1].replace(/XTION_ESCAPED_SEMICOLON/g,";")),a[u[0]]=u[1];for(var u=o[i].attributes,l=u.length;l--;)0===u[l].nodeName.indexOf("data-xtion-")&&(a[u[l].nodeName.replace("data-xtion-","")]=u[l].nodeValue);window.Xtion_detected[s]||(window.Xtion_detected[s]=[]);var p=window.xtion.detection[s](o[i],a);window.Xtion_detected[s].push(p),a.name&&(window[a.name]=p);break}}}window.xtion=window.xtion||{},xtion.detection=xtion.detection||{},xtion.scroll_body=xtion.scroll_body||document.documentElement.scrollTop&&document.documentElement||document.body,"function"!=typeof Array.move&&(Array.prototype.move=function(t,e){this.splice(e,0,this.splice(t,1)[0])}),"remove"!=typeof Array.remove&&(Array.prototype.remove=function(){for(var t,e,n=arguments,o=n.length;o&&this.length;)for(t=n[--o];-1!==(e=this.indexOf(t));)this.splice(e,1);return this}),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(t){"use strict";if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var e=Object(t),n=1;n<arguments.length;n++){var o=arguments[n];if(void 0!==o&&null!==o){o=Object(o);for(var i=Object.keys(o),s=0,a=i.length;s<a;s++){var r=i[s],c=Object.getOwnPropertyDescriptor(o,r);void 0!==c&&c.enumerable&&(e[r]=o[r])}}}return e}}),HTMLCollection.prototype.forEach=function(t){for(var e=0;e<this.length;e++)t(this[e],e)},NodeList.prototype.forEach=HTMLCollection.prototype.forEach;var Xtion_base64_key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Xtion_popups=[];!window.addEventListener&&function(t,e,n,o,i,s,a){t[o]=e[o]=n[o]=function(t,e){var n=this;a.unshift([n,t,e,function(t){t.currentTarget=n,t.preventDefault=function(){t.returnValue=!1},t.stopPropagation=function(){t.cancelBubble=!0},t.target=t.srcElement||n,e.call(n,t)}]),this.attachEvent("on"+t,a[0][3])},t[i]=e[i]=n[i]=function(t,e){for(var n,o=0;n=a[o];++o)if(n[0]==this&&n[1]==t&&n[2]==e)return this.detachEvent("on"+t,a.splice(o,1)[0][3])},t[s]=e[s]=n[s]=function(t){return this.fireEvent("on"+t.type,t)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]),"function"!=typeof document.getElementsByClassName&&"object"==typeof Element&&(document.getElementsByClassName=Element.prototype.getElementsByClassName=function(t){for(var e=[],n=new RegExp("(^| )"+t+"( |$)"),o=this.getElementsByTagName("*"),i=0,s=o.length;i<s;i++)n.test(o[i].className)&&e.push(o[i]);return e}),"function"!=typeof window.getComputedStyle&&(window.getComputedStyle=function(t,e){return this.e=t,this.getPropertyValue=function(e){var n=/(-([a-z]))/g;return"float"==e&&(e="styleFloat"),n.test(e)&&(e=e.replace(n,function(){return arguments[2].toUpperCase()})),t.currentStyle[e]?t.currentStyle[e]:null},this}),Object.keys||(Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=n.length;return function(i){if("object"==typeof i||"function"==typeof i&&null!==i){var s,a,r=[];for(s in i)t.call(i,s)&&r.push(s);if(e)for(a=0;a<o;a++)t.call(i,n[a])&&r.push(n[a]);return r}throw new TypeError("Object.keys called on non-object")}}()),"document"in self&&("classList"in document.createElement("_")?function(){var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,o=arguments.length;for(n=0;n<o;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}t=null}():function(t){if("Element"in t){t=t.Element.prototype;var e=Object,n=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array.prototype.indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},i=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},s=function(t,e){if(""===e)throw newe("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new i("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(t,e)},a=function(t){for(var e=n.call(t.getAttribute("class")||""),o=0,i=(e=e?e.split(/\s+/):[]).length;o<i;o++)this.push(e[o]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},r=a.prototype=[],c=function(){return new a(this)};if(i.prototype=Error.prototype,r.item=function(t){return this[t]||null},r.contains=function(t){return-1!==s(this,t+"")},r.add=function(){var t,e=arguments,n=0,o=e.length,i=!1;do{t=e[n]+"",-1===s(this,t)&&(this.push(t),i=!0)}while(++n<o);i&&this._updateClassName()},r.remove=function(){var t,e,n=arguments,o=0,i=n.length,a=!1;do{for(t=n[o]+"",e=s(this,t);-1!==e;)this.splice(e,1),a=!0,e=s(this,t)}while(++o<i);a&&this._updateClassName()},r.toggle=function(t,e){t+="";var n=this.contains(t),o=n?!0!==e&&"remove":!1!==e&&"add";return o&&this[o](t),!0===e||!1===e?e:!n},r.toString=function(){return this.join(" ")},e.defineProperty){r={get:c,enumerable:!0,configurable:!0};try{e.defineProperty(t,"classList",r)}catch(n){-2146823252===n.number&&(r.enumerable=!1,e.defineProperty(t,"classList",r))}}else e.prototype.__defineGetter__&&t.__defineGetter__("classList",c)}}(self)),xtion.detection.Xtion_focused=function(t,e){t.focus()},window.addEventListener("load",function(){document.querySelectorAll("select[data-xtion-selected]").forEach(function(t){var e=t.getAttribute("data-xtion-selected");t.options.forEach(function(n){e===n.value&&(t.value=e,!t.getAttribute("data-xtion-selected-nochange")&&t.onchange&&t.onchange())})})}),xtion.detection.Xtion_collapsible=function(t){t.querySelector("a").addEventListener("click",function(){var t=this.parentNode.classList;t[t.contains("opened")?"remove":"add"]("opened")})},xtion.detection.Xtion_title=function(t){t.getAttribute("data-title")||(t.setAttribute("data-title",t.title),t.title=""),t.addEventListener("mouseover",function(){if(!t.querySelector(".Xtion_title_popup")){var e=document.createElement("div");e.className="Xtion_title_popup",e.textContent=t.getAttribute("data-title"),t.appendChild(e);var n=Xtion_element_coordinates(t,!0);e.style.top=n.top+"px",e.style.left=n.left+t.offsetWidth/2+"px"}}),t.addEventListener("mouseout",function(){document.querySelectorAll(".Xtion_title_popup").forEach(function(t){t.parentNode.removeChild(t)})})},xtion.detection.Xtion_time_ago=function(t){t.innerHTML&&(t.setAttribute("title",t.innerHTML),t.innerHTML=Xtion_time_ago(t.innerHTML))},xtion.detection.Xtion_time_ago_moment=function(t){if(t.innerHTML&&!t.getAttribute("data-xtion-timestamp")){var e=function(){var e=t.textContent;t.setAttribute("data-xtion-timestamp",e);var n=moment.tz(e,TIMEZONE).tz(moment.tz.guess());t.textContent=n.fromNow().replace("a few ","")+", "+n.format("MMM Do YYYY, h:mm:ss a")};window.moment?e():Xtion_script(LOCATION_STATIC+"global/framework/moment/moment.min.js",function(){Xtion_script(LOCATION_STATIC+"global/framework/moment/moment-timezone-with-data.min.js",function(){e()})})}},xtion.detection.Xtion_popup=function(t,e){return new XtionPopup(t,e)},XtionForm.prototype.Initialize=function(){var that=this;this.success_true||(this.success_true="Form Successfully Submitted",this.output&&(this.success_true='<span class="Xtion_form_output_success">'+this.success_true+"</span>")),this.success_false||(this.success_false="Your form failed to submit, please try again.",this.output&&(this.success_false='<span class="Xtion_form_output_failure">'+this.success_false+"</span>")),this.form.submit=function(){this.dispatchEvent(new Event("submit",{bubbles:!1,cancelable:!0}))},this.form.addEventListener("submit",function(e){if(e){if(e.defaultPrevented)return;e.preventDefault()}if(that.action=that.form.getAttribute("action"),that.action){if(~that.action.indexOf("javascript:"))return void eval(that.action.substr(11))}else that.action=window.location.pathname+window.location.search;that.method=that.form.getAttribute("method"),that.method||(that.method="get");var that_parameters=that.parameters;if("object"==typeof that.parameters){that_parameters="";for(var n in that.parameters)that.parameters.hasOwnProperty(n)&&(that_parameters+=n+"="+encodeURIComponent(that.parameters[n])+"&")}if(xtion.csrf&&(that_parameters+="&_t="+encodeURIComponent(xtion.csrf)),void 0!==window.CKEDITOR)for(var editors=this.getElementsByClassName("cke"),i=editors.length;i--;){var n=CKEDITOR.instances[editors[i].id.substr(4)];n&&(n.element.$.value=n.getData())}that.errors=0;for(var inputs=that.form.querySelectorAll("input,select,textarea,.Xtion_form_input"),parameters=""===that_parameters?"":that_parameters+("&"===that_parameters.slice(-1)?"":"&"),parameters_custom={},c=0,l=inputs.length;c<l;c++){var name=inputs[c].getAttribute("data-xtion-name")||inputs[c].name,value=~inputs[c].className.indexOf("Xtion_form_input")?inputs[c].innerHTML:"checkbox"===inputs[c].type?inputs[c].checked?1:0:"file"===inputs[c].type?"":inputs[c].value,ps=that.input_parameters[name],p=ps?ps.split(","):null;if("file"===inputs[c].type)var file_upload=1;if(""===value&&"SELECT"===inputs[c].tagName&&null===inputs[c].getAttribute("multiple")){var o=inputs[c].options[inputs[c].selectedIndex];o&&(value=o.innerHTML)}if(!that.disable_hidden||null!==inputs[c].offsetParent||inputs[c].classList.contains("ckeditor")||"hidden"===inputs[c].type&&null!==inputs[c].parentNode.offsetParent||(inputs[c].disabled=!0),!ps||value[parseInt(p[0])-1]&&!value[p[1]]){parameters+=name+"="+encodeURIComponent(value)+"&",~inputs[c].className.indexOf("Xtion_form_input")&&(parameters_custom[name]=value);var e=this.getElementsByClassName("Xtion_form_error_"+name)[0];e&&("visibility"==that.error_show?e.style.visibility="hidden":"display"==that.error_show&&(e.style.display="none"))}else if(that.errors++,"text"===that.error_type){that.output.innerHTML=that.output_error;var e=this.getElementsByClassName("Xtion_form_error_"+name)[0];e&&("visibility"===that.error_show?e.style.visibility="visible":"display"===that.error_show&&(e.style.display=""))}else"alert"==that.error_type&&alert(that.output_error)}if(0==that.errors){var m=that.method,a=that.action;a||(a=window.location.href);var loading_overlay=that.loading_overlay?Xtion_popup_loading(1!=that.loading_overlay?{message:that.loading_overlay}:{}):null;if(that.success_function&&that.success_function(),that.output&&(that.output.innerHTML=that.output_loading),that.flatten){var p=that.flatten+"="+JSON.stringify(Xtion_form_to_json(this))+"&";"post"===m?that_parameters+="&"+p:parameters+=p}var request=new XMLHttpRequest;if(request.open(m,a+("get"===m?"?"+parameters:""),!0),that.output_progressive&&(request.onprogress=function(){that.output.innerHTML=request.responseText}),that.form_submitted_button&&that.form_submitted_button.name&&(parameters_custom[that.form_submitted_button.name]=that.form_submitted_button.value),request.onerror=request.ontimeout=function(){loading_overlay&&loading_overlay.close()},"post"===m)if("function"==typeof FormData){for(var d=new FormData(this),p=that_parameters.split("&"),i=p.length;i--;)if(""!==p[i]){var pair=p[i].split("=");d.append(pair[0],""!==pair[1]?decodeURIComponent(pair[1]):"")}for(var n in parameters_custom)parameters_custom.hasOwnProperty(n)&&d.append(n,parameters_custom[n]);request.send(d)}else if(1===file_upload){var frame=document.createElement("iframe");frame.src=a,frame.setAttribute("name","Xtion_form_temp"),frame.style.display="none",this.target="Xtion_form_temp",that.output.appendChild(frame);var frame_html=document.createElement("html");frame.appendChild(frame_html.appendChild(document.createElement("body"))),this.submit(),request={compatibility:1,readyState:4,status:200}}else request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),request.send(parameters);else request.send();request.onreadystatechange=function(){if(4===request.readyState)if(loading_overlay&&loading_overlay.close(),200===request.status){var t=request.responseText;if("bool"===that.success_output)"1"===t?(that.output?that.output.innerHTML=that.success_true:"0"!==that.success_true&&alert(that.success_true),that.success_true_function&&that.success_true_function(t,that.form),that.success_true_hide&&(that.success_true_hide===that.form?that.form.children.forEach(function(t){t.classList.contains("Xtion_form_output")||(t.style.display="none")}):that.success_true_hide.style.display="none"),that.success_true_redirect&&(window.location.href=that.success_true_redirect),that.success_true_refresh&&window.location.reload(),that.success_true_reset&&that.form.reset()):("0"===t||""===t?that.output?that.output.innerHTML=that.success_false:alert(that.success_false):"alert"===that.success_false_output?alert(t):that.success_false_output&&(that.output?that.output.innerHTML=t:alert(t)),that.success_false_function&&that.success_false_function(t));else if("function"===that.success_output)that.output&&(that.output.innerHTML=""),that.success_true_function(t,that.form);else if("temporary"===that.success_output)Xtion_popup_temporary(that.success_true);else if("json"===that.success_output){try{var e=JSON.parse(t)}catch(e){return void alert(t)}e&&that.success_true_function(e,that.form)}else"alert"==that.success_output?alert(t):that.output.innerHTML=request.responseText}else 404==request.status&&(that.output.innerHTML="404 Not Found")},1===request.compatibility&&(frame.onload=function(){request.responseText=frame.contentWindow.document.body.innerHTML,request.onreadystatechange()})}}),this.form.elements.forEach(function(t){"BUTTON"!==t.tagName&&("INPUT"!==t.tagName||"submit"!==t.type&&"button"!==t.type)||t.addEventListener("click",function(){that.form_submitted_button=this,setTimeout(function(){that.form_submitted_button=null},1500)})})},xtion.detection.Xtion_form=function(t,e){var n=new XtionForm(t),o=t.getElementsByClassName("Xtion_form_output");o.length&&(n.output=o[0]);for(var i in e)if(e.hasOwnProperty(i))switch(i){case"output":n.output=document.getElementById(e[i]);break;case"parameters":n.parameters=e[i];break;case"error_type":n.error_type=e[i];break;case"error_show":n.error_show=e[i];break;case"loading_overlay":n.loading_overlay=e[i];break;case"output_loading":n.output_loading=e[i];break;case"output_error":n.output_error=e[i];break;case"output_progressive":n.output_progressive=e[i];break;case"output_error_show":n.error_show=e[i];break;case"success_function":n.success_function=new Function("r",e[i]);break;case"success_output":n.success_output=e[i];break;case"success_output_function":n.success_output_function=new Function("r",e[i]);break;case"success_true":n.success_true=n.output?'<span class="Xtion_form_output_success">'+e[i]+"</span>":e[i];break;case"success_true_function":n.success_true_function=new Function("r","f",e[i]);break;case"success_true_hide":n.success_true_hide=1==e[i]?t:document.getElementById(e[i]);break;case"success_true_reset":n.success_true_reset=e[i];break;case"success_false":n.success_false=n.output?'<span class="Xtion_form_output_failure">'+e[i]+"</span>":e[i];break;case"success_false_function":n.success_false_function=new Function("r",e[i]);break;case"success_false_output":n.success_false_output=e[i];break;default:if("name"!==i)try{if(i)if(void 0!==n[i])try{n[i]=""===e[i]?1:e[i]}catch(t){console.error("Xtion_form Attribute Value Error("+t+"): Please change the value ("+i+"="+e[i]+")")}else console.error("Xtion_form Error: Invalid Attribute ("+i+")")}catch(t){console.error("Xtion_form Error: Invalid Attribute ("+i+")")}}return o||(n.success_false_output="alert"),n.Initialize(),n},XtionSwitcher.prototype.Initialize=function(){var t=this;if(this.loads=this.content.children,"SELECT"===this.controller.tagName)this.controller.onchange=function(){for(var e=t.content.querySelectorAll("input,select,textarea"),n=e.length;n--;)e[n].disabled=!0;var o=this.selectedIndex;for(this.options[this.selectedIndex].getAttribute("data-xtion-switch")&&(o=parseInt(this.options[this.selectedIndex].getAttribute("data-xtion-switch"))),n=t.loads.length;n--;)if(n===o){t.loads[n].style.display="";for(var i=(e=t.loads[n].querySelectorAll("input,select,textarea")).length;i--;)e[i].disabled=!1,e[i].classList.contains("Xtion_switcher")&&e[i].onchange&&null!=e[i].offsetParent&&e[i].onchange()}else t.loads[n].style.display="none";t.func&&t.func(this.value,this)},t.content.querySelector(".Xtion_switcher")?setTimeout(function(){t.controller.onchange()},250):this.controller.onchange();else{this.actions=this.controller.children;for(var e=this.actions.length;e--;)this.actions[e].addEventListener("click",function(){for(var e=t.actions.length;e--;)t.actions[e]==this?(this.classList.add(t.actions_selected),t.loads[e].classList.add(t.loads_selected),t.current=e,"function"==typeof t.func&&(t.function_after_first?t.function_after_first=0:setTimeout(function(){t.func(t.current)},0))):t.actions[e].classList.contains(t.actions_selected)&&(t.actions[e].classList.remove(t.actions_selected),t.loads[e].classList.remove(t.loads_selected))});this.load_hashes&&this.load_hashes[window.location.hash]?this.actions[this.load_hashes[window.location.hash]].click():-1==this.selected||0!=this.selected&&!this.selected||this.actions[this.selected].click()}},xtion.detection.Xtion_switcher=function(e,options){var object=new XtionSwitcher(e);"SELECT"===e.tagName?(object.controller=e,object.content="LABEL"===e.parentNode.tagName||"TD"===e.parentNode.tagName?e.parentNode.nextSibling:e.nextSibling):(object.controller=e.getElementsByClassName("Xtion_switcher_controller")[0],object.content=e.getElementsByClassName("Xtion_switcher_content")[0]);for(var name in options)if(options.hasOwnProperty(name))switch(name){case"type":object.type=options[name];break;case"content":object.content=document.getElementById(options[name]);break;case"actions_selected":object.actions_selected=options[name];break;case"loads_selected":object.loads_selected=options[name];break;case"load_hashes":object.load_hashes=eval('{"'+options[name].replace(/=/g,'":"').replace(/,/g,'","')+'"}');break;case"selected":object.selected=options[name];break;case"function":case"func":object.func=new Function("n","e",options[name]);break;case"function_after_first":object.function_after_first=options[name]}return object.Initialize(),object},xtion.detection.Xtion_autoexpand=function(t,e){var n=new XtionAutoexpand(t,t.style.height||window.getComputedStyle(t).height);return n.Initialize(),null!==n.element.offsetParent&&n.element.onkeyup(),n},Xtion_slideshow.prototype.Initialize=function(){var t=this;for(this.slides=this.slideshow.children,this.delay_change||(this.delay_change=this.delay),this.image_amount=this.slides.length,e=0;e<this.image_amount;e++)this.image_length[e]=100*e;if(this.speed_change=0==this.speed_change?this.speed/(this.image_amount>2?this.image_amount>6?this.image_amount:this.image_amount/2:1):this.speed_change,this.image_amount>1){for(this.slideshow_width=this.slideshow.style.width=100*this.image_amount+"%",e=0;e<this.image_amount;e++)this.slideshow.children[e].style.width=100/this.image_amount+"%";if(this.navigation_arrows&&(this.navigation_arrow_previous=document.createElement("button"),this.navigation_arrow_previous.className="Xtion_slideshow_navigation_arrow Xtion_slideshow_navigation_arrow_previous",this.navigation_arrow_previous.onclick=function(){t.Navigate(-1)},this.navigation_arrow_next=document.createElement("button"),this.navigation_arrow_next.className="Xtion_slideshow_navigation_arrow Xtion_slideshow_navigation_arrow_next",this.navigation_arrow_next.onclick=function(){t.Navigate(-2)}),this.navigation&&this.Navigation(),"together"===this.navigation_arrows||"outside"===this.navigation_arrows){var e=1==this.navigation_arrows_outside?this.container:this.navigation,n=document.createElement("div");n.className="Xtion_slideshow_navigation_arrows",n.appendChild(this.navigation_arrow_previous),n.appendChild(this.navigation_arrow_next),e.appendChild(n),1==this.navigation_arrows_hide&&(this.container.onmouseover=this.container.onmouseout=function(t){t=t||window.event;for(var e=this.getElementsByClassName("Xtion_slideshow_navigation_arrows")[0],n=e.length;n--;)e[n].style.display="mouseover"==t.type?"block":""})}this.slides[0].style.opacity=1,1==this.auto&&setTimeout(function(){t.Fade()},this.delay)}else 1==this.run_with_one&&1==this.image_amount&&this.Navigation()},Xtion_slideshow.prototype.Navigation=function(){var t=this;if("inside"===this.navigation_arrows&&this.navigation.appendChild(this.navigation_arrow_previous),this.nav_buttons){this.navigation_buttons_container=document.createElement("div"),this.navigation_buttons_container.classList.add("Xtion_slideshow_navigation_buttons"),this.navigation_buttons=[];for(var e=0;e<this.image_amount;e++){switch(this.nav_buttons){case"numbers":(n=document.createElement("button")).value=e+1;break;case"image":(n=document.createElement("input")).type="image",n.src=this.nav_buttons_image;break;case"thumbnail":(n=document.createElement("input")).type="image",n.src=this.slideshow.getElementsByTagName("img")[e].src;break;default:var n=document.createElement("button")}n.className="Xtion_slideshow_navigation_button"+(0===e?" Xtion_slideshow_navigation_button_selected":""),n.setAttribute("data-Xtion_slideshow_navigation_number",e),n.onclick=function(){t.Navigate(this.getAttribute("data-Xtion_slideshow_navigation_number"))},this.navigation_buttons_container.appendChild(n),this.navigation_buttons.push(n)}this.navigation.appendChild(this.navigation_buttons_container)}"inside"===this.navigation_arrows&&this.navigation.appendChild(this.navigation_arrow_next)},Xtion_slideshow.prototype.Fade=function(t){if(!this.changing&&0!=this.auto){var e=this,n=this.slides[this.current_slide];if(void 0==t){for(var o=this.current_slide==this.image_amount-1?0:parseInt(this.current_slide)+1,i=0;i<this.image_amount;i++)this.slides[i].style.display="none",this.slides[i].style.position="",this.slides[i].style.opacity=1,this.slides[i].style.zIndex="";n.style.zIndex="3",n.style.position="absolute",n.style.display="",this.slides[o].style.display=""}if(n.style.opacity<.3){if(this.navigation_buttons)for(var s=this.navigation_buttons.length;s--;)this.navigation_buttons[s].classList.remove("Xtion_slideshow_navigation_button_selected"),1==this.nav_button_type&&(document.getElementById(this.name+"_nav"+i).src=this.nav_button);n.style.opacity=0,n.style.display="none",this.current_slide!=this.image_amount-1?(this.current_slide++,this.navigation_buttons&&(this.navigation_buttons[this.current_slide].classList.add("Xtion_slideshow_navigation_button_selected"),1==this.nav_button_type&&(document.getElementById(this.name+"_nav"+this.current_slide).src=this.nav_button_selected))):(this.current_slide=0,this.navigation_buttons&&(this.navigation_buttons[this.current_slide].classList.add("Xtion_slideshow_navigation_button_selected"),"image"===this.nav_button&&(this.navigation_buttons[this.current_slide].src=this.nav_button_selected))),this.onslidechange&&this.onslidechange(this.current_slide),this.slideshow_pause=setTimeout(function(){e.Fade()},this.delay)}else n.style.opacity-=.1,this.slideshow_change=setTimeout(function(){e.Fade(0)},this.speed)}},Xtion_slideshow.prototype.Navigate=function(t){if(!this.changing){this.changing=1;var e=this;if(clearTimeout(this.slideshow_timer),clearTimeout(this.slideshow_pause),clearTimeout(this.slideshow_change),clearTimeout(this.slideshow_continue),t<0){var n=Math.floor(this.current_slide);t=-1==t?n-1<0?this.image_amount-1:n-1:n+1>this.image_amount-1?0:n+1}if(this.navigation_buttons)for(o=this.navigation_buttons.length;o--;)this.navigation_buttons[o].getAttribute("data-Xtion_slideshow_navigation_number")==t?~this.navigation_buttons[o].className.indexOf("Xtion_slideshow_navigation_button_selected")||(this.navigation_buttons[o].className+=" Xtion_slideshow_navigation_button_selected"):this.navigation_buttons[o].className=this.navigation_buttons[o].className.replace("Xtion_slideshow_navigation_button_selected");if(this.onslidechange&&this.onslidechange(t),t!=this.current_slide)this.Change_Fade(t);else{for(var o=this.slides.length;o--;)this.slides[o].style.opacity=o==t?1:0;this.slideshow_pause=setTimeout(function(){e.changing=0,e.Fade()},this.delay_change),this.changing=0}}},Xtion_slideshow.prototype.Change_Fade=function(t,e){var n=this,o=this.slides[this.current_slide];if(void 0==e){if(1!=o.style.opacity&&o.style.opacity>0)return o.style.opacity=0,o.style.display="none",this.changing=0,void(this.current_slide=t);for(var i=0;i<this.image_amount;i++)this.slides[i].style.display="none",this.slides[i].style.position="",this.slides[i].style.opacity=1,this.slides[i].style.zIndex="";o.style.zIndex="3",o.style.position="absolute",o.style.display="",this.slides[t].style.display=""}o.style.opacity<.3?(o.style.opacity=0,o.style.display="none",this.current_slide=t,this.changing=0,this.auto&&(this.slideshow_change=setTimeout(function(){n.Fade()},this.delay_change))):(o.style.opacity-=.1,this.slideshow_change=setTimeout(function(){n.changing=0,n.Change_Fade(t,0)},this.speed))},xtion.detection.Xtion_slideshow=function(t,e){var n=new Xtion_slideshow;n.slideshow=t.getElementsByClassName("Xtion_slideshow_slides")[0],n.navigation=t.getElementsByClassName("Xtion_slideshow_navigation")[0];for(var o in e)if(e.hasOwnProperty(o))switch(o){case"onslidechange":n.onslidechange=new Function("n",e.onslidechange);break;default:if("name"!==o)try{if(o)if(void 0!==n[o])try{n[o]=""===e[o]?1:e[o]}catch(t){console.error("Xtion_form Attribute Value Error("+t+"): Please change the value ("+o+"="+e[o]+")")}else console.error("Xtion_form Error: Invalid Attribute ("+o+")")}catch(t){console.error("Xtion_form Error: Invalid Attribute ("+o+")")}}return n.Initialize(),n},window.Xtion_detected={},window.Xtion_detected_elements=[],Xtion_detect();
